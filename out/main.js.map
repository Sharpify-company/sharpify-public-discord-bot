{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { NestFactory } from \"@nestjs/core\";\r\nimport { AppModule } from \"@/app.module\";\r\nimport { TypeormProvider } from \"./@shared/db/typeorm\";\r\nimport { Sharpify } from \"./@shared/sharpify\";\r\nimport { StoreConfigEntity } from \"./@shared/db/entities\";\r\n\r\nasync function bootstrap() {\r\n\tawait TypeormProvider.init();\r\n\r\n\tconst getStoreReq = await Sharpify.api.v1.management.store.getStore();\r\n\tif (!getStoreReq.success) {\r\n\t\tthrow new Error(\r\n\t\t\t`\r\n\t\t\tBuscar configuracao da loja falhou quando inicializando a aplicacão\r\n\t\t\tVerifique se a API_KEY e STORE_ID estão corretos, para mais detalhes veja o log abaixo.:\r\n\t\t\t` + getStoreReq.errorName,\r\n\t\t);\r\n\t}\r\n\r\n\tlet storeConfigEntity = await StoreConfigEntity.findOneBy({ id: \"DEFAULT\" });\r\n\tif (!storeConfigEntity) await StoreConfigEntity.createStore(getStoreReq.data).save();\r\n\telse await storeConfigEntity.updateProps(getStoreReq.data);\r\n\r\n\tawait NestFactory.createApplicationContext(AppModule);\r\n\r\n\t// await app.listen(process.env.PORT ?? 3000);\r\n}\r\nbootstrap();\r\n"],"names":["bootstrap","TypeormProvider","init","getStoreReq","Sharpify","api","v1","management","store","getStore","success","Error","errorName","storeConfigEntity","StoreConfigEntity","findOneBy","id","createStore","data","save","updateProps","NestFactory","createApplicationContext","AppModule"],"mappings":";;;;sBAA4B;2BACF;yBACM;0BACP;0BACS;AAElC,eAAeA;IACd,MAAMC,wBAAe,CAACC,IAAI;IAE1B,MAAMC,cAAc,MAAMC,kBAAQ,CAACC,GAAG,CAACC,EAAE,CAACC,UAAU,CAACC,KAAK,CAACC,QAAQ;IACnE,IAAI,CAACN,YAAYO,OAAO,EAAE;QACzB,MAAM,IAAIC,MACT,CAAC;;;GAGD,CAAC,GAAGR,YAAYS,SAAS;IAE3B;IAEA,IAAIC,oBAAoB,MAAMC,2BAAiB,CAACC,SAAS,CAAC;QAAEC,IAAI;IAAU;IAC1E,IAAI,CAACH,mBAAmB,MAAMC,2BAAiB,CAACG,WAAW,CAACd,YAAYe,IAAI,EAAEC,IAAI;SAC7E,MAAMN,kBAAkBO,WAAW,CAACjB,YAAYe,IAAI;IAEzD,MAAMG,iBAAW,CAACC,wBAAwB,CAACC,oBAAS;AAEpD,8CAA8C;AAC/C;AACAvB"}