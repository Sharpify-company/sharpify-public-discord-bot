{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { NestFactory } from \"@nestjs/core\";\r\nimport { AppModule } from \"@/app.module\";\r\nimport { TypeormProvider } from \"./@shared/db/typeorm\";\r\nimport { Sharpify } from \"./@shared/sharpify\";\r\nimport { StoreConfigEntity } from \"./@shared/db/entities\";\r\n\r\n// --- ADICIONE ISSO AQUI PARA EVITAR CRASH ---\r\nprocess.on('unhandledRejection', (reason, promise) => {\r\n    console.error('üö® [Anti-Crash] Rejei√ß√£o de Promise n√£o tratada:', reason);\r\n    // O simples fato de ouvir esse evento impede o Node de fechar o processo\r\n});\r\n\r\nprocess.on('uncaughtException', (error) => {\r\n    console.error('üö® [Anti-Crash] Erro n√£o capturado:', (error?.name));\r\n    // Impede o fechamento abrupto\r\n});\r\n// -------------------------------------------\r\n\r\nasync function bootstrap() {\r\n\tawait TypeormProvider.init();\r\n\r\n\tconst getStoreReq = await Sharpify.api.v1.management.store.getStore();\r\n\tif (!getStoreReq.success) {\r\n\t\tthrow new Error(\r\n\t\t\t`\r\n\t\t\tBuscar configuracao da loja falhou quando inicializando a aplicac√£o\r\n\t\t\tVerifique se a API_KEY e STORE_ID est√£o corretos, para mais detalhes veja o log abaixo.:\r\n\t\t\t` + getStoreReq.errorName,\r\n\t\t);\r\n\t}\r\n\r\n\tlet storeConfigEntity = await StoreConfigEntity.findOneBy({ id: \"DEFAULT\" });\r\n\tif (!storeConfigEntity) await StoreConfigEntity.createStore(getStoreReq.data).save();\r\n\telse await storeConfigEntity.updateProps(getStoreReq.data);\r\n\r\n\tconst app = await NestFactory.create(AppModule);\r\n\r\n\tawait app.init();\r\n}\r\nbootstrap();\r\n"],"names":["process","on","reason","promise","console","error","name","bootstrap","TypeormProvider","init","getStoreReq","Sharpify","api","v1","management","store","getStore","success","Error","errorName","storeConfigEntity","StoreConfigEntity","findOneBy","id","createStore","data","save","updateProps","app","NestFactory","create","AppModule"],"mappings":";;;;sBAA4B;2BACF;yBACM;0BACP;0BACS;AAElC,+CAA+C;AAC/CA,QAAQC,EAAE,CAAC,sBAAsB,CAACC,QAAQC;IACtCC,QAAQC,KAAK,CAAC,oDAAoDH;AAClE,yEAAyE;AAC7E;AAEAF,QAAQC,EAAE,CAAC,qBAAqB,CAACI;IAC7BD,QAAQC,KAAK,CAAC,uCAAwCA,OAAOC;AAC7D,8BAA8B;AAClC;AACA,8CAA8C;AAE9C,eAAeC;IACd,MAAMC,wBAAe,CAACC,IAAI;IAE1B,MAAMC,cAAc,MAAMC,kBAAQ,CAACC,GAAG,CAACC,EAAE,CAACC,UAAU,CAACC,KAAK,CAACC,QAAQ;IACnE,IAAI,CAACN,YAAYO,OAAO,EAAE;QACzB,MAAM,IAAIC,MACT,CAAC;;;GAGD,CAAC,GAAGR,YAAYS,SAAS;IAE3B;IAEA,IAAIC,oBAAoB,MAAMC,2BAAiB,CAACC,SAAS,CAAC;QAAEC,IAAI;IAAU;IAC1E,IAAI,CAACH,mBAAmB,MAAMC,2BAAiB,CAACG,WAAW,CAACd,YAAYe,IAAI,EAAEC,IAAI;SAC7E,MAAMN,kBAAkBO,WAAW,CAACjB,YAAYe,IAAI;IAEzD,MAAMG,MAAM,MAAMC,iBAAW,CAACC,MAAM,CAACC,oBAAS;IAE9C,MAAMH,IAAInB,IAAI;AACf;AACAF"}