{"version":3,"sources":["../../../../../src/@shared/db/entities/product/product.entity.ts"],"sourcesContent":["import { ProductProps } from \"@/@shared/sharpify/api\";\r\nimport { BaseEntity, Column, Entity, PrimaryColumn } from \"typeorm\";\r\n\r\n@Entity(\"products\")\r\nexport class ProductEntity extends BaseEntity {\r\n\t@PrimaryColumn({ name: \"id\", type: \"text\" })\r\n\tid!: string;\r\n\r\n\t@Column({ name: \"orderProps\", type: \"json\" })\r\n\tproductProps!: ProductProps;\r\n\r\n\t@Column({ name: \"channelsLinked\", type: \"json\" })\r\n\tchannelsLinked!: ProductEntity.ChannelsLinked[];\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tstatic createProduct(props: ProductEntity.Input) {\r\n\t\tconst defaultProps: ProductEntity.Props = {\r\n\t\t\t...props,\r\n\t\t\tchannelsLinked: props.channelsLinked || [],\r\n\t\t};\r\n\t\tconst entity = new ProductEntity();\r\n\t\tObject.assign(entity, defaultProps);\r\n\t\treturn entity;\r\n\t}\r\n\r\n\tasync updateProps(props: ProductProps) {\r\n\t\tthis.productProps = props;\r\n\t\tawait this.save();\r\n\t}\r\n\r\n\tasync setChannelLinked({ channelId, messageId }: { channelId: string; messageId: string }) {\r\n\t\tconst existing = this.channelsLinked.find((c) => c.channelId === channelId);\r\n\t\tif (existing) {\r\n\t\t\texisting.messageId = messageId;\r\n\t\t} else {\r\n\t\t\tthis.channelsLinked.push({ channelId, messageId });\r\n\t\t}\r\n\t\tthis.save()\r\n\t}\r\n}\r\n\r\nexport namespace ProductEntity {\r\n\texport type ChannelsLinked = {\r\n\t\tchannelId: string;\r\n\t\tmessageId: string;\r\n\t};\r\n\r\n\texport type Input = {\r\n\t\tid: string;\r\n\t\tproductProps: ProductProps;\r\n\t\tchannelsLinked?: ProductEntity.ChannelsLinked[];\r\n\t};\r\n\r\n\texport type Props = {\r\n\t\tid: string;\r\n\t\tproductProps: ProductProps;\r\n\t\tchannelsLinked: ProductEntity.ChannelsLinked[];\r\n\t};\r\n}\r\n"],"names":["ProductEntity","BaseEntity","createProduct","props","defaultProps","channelsLinked","entity","Object","assign","updateProps","productProps","save","setChannelLinked","channelId","messageId","existing","find","c","push","name","type"],"mappings":";;;;+BAIaA;;;eAAAA;;;qBAJgB;yBAC6B;;;;;;;;;;AAGnD,IAAA,AAAMA,gBAAN,MAAMA,sBAAsBC,mBAAU;IAc5C,OAAOC,cAAcC,KAA0B,EAAE;QAChD,MAAMC,eAAoC;YACzC,GAAGD,KAAK;YACRE,gBAAgBF,MAAME,cAAc,IAAI,EAAE;QAC3C;QACA,MAAMC,SAAS,IAAIN;QACnBO,OAAOC,MAAM,CAACF,QAAQF;QACtB,OAAOE;IACR;IAEA,MAAMG,YAAYN,KAAmB,EAAE;QACtC,IAAI,CAACO,YAAY,GAAGP;QACpB,MAAM,IAAI,CAACQ,IAAI;IAChB;IAEA,MAAMC,iBAAiB,EAAEC,SAAS,EAAEC,SAAS,EAA4C,EAAE;QAC1F,MAAMC,WAAW,IAAI,CAACV,cAAc,CAACW,IAAI,CAAC,CAACC,IAAMA,EAAEJ,SAAS,KAAKA;QACjE,IAAIE,UAAU;YACbA,SAASD,SAAS,GAAGA;QACtB,OAAO;YACN,IAAI,CAACT,cAAc,CAACa,IAAI,CAAC;gBAAEL;gBAAWC;YAAU;QACjD;QACA,IAAI,CAACH,IAAI;IACV;IA3BA,aAAc;QACb,KAAK;IACN;AA0BD;;;QArCkBQ,MAAM;QAAMC,MAAM;;;;;;QAGzBD,MAAM;QAAcC,MAAM;;;;;;QAG1BD,MAAM;QAAkBC,MAAM"}