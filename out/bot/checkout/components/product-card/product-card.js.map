{"version":3,"sources":["../../../../../src/bot/checkout/components/product-card/product-card.ts"],"sourcesContent":["import { Injectable } from \"@nestjs/common\";\r\nimport { Modal, Context, SlashCommand, SlashCommandContext, Ctx, ModalContext } from \"necord\";\r\nimport {\r\n\tActionRowBuilder,\r\n\tCacheType,\r\n\tChatInputCommandInteraction,\r\n\tEmbedBuilder,\r\n\tModalActionRowComponentBuilder,\r\n\tModalBuilder,\r\n\tModalSubmitInteraction,\r\n\tTextChannel,\r\n\tTextInputBuilder,\r\n\tTextInputStyle,\r\n} from \"discord.js\";\r\nimport { BotConfig } from \"@/config\";\r\nimport { ProductProps } from \"@/@shared/sharpify/api\";\r\nimport { formatPrice } from \"@/@shared/lib\";\r\nimport TurndownService from \"turndown\";\r\nimport { AddToCartButtonComponent } from \"./components/add-to-cart-button\";\r\nimport { MemoryCreateConfig } from \"@/bot/products/commands/list-products/memory-create-config\";\r\n\r\n@Injectable()\r\nexport class ProductCardComponent {\r\n\tconstructor(private readonly addToCartButtonComponent: AddToCartButtonComponent) {}\r\n\r\n\tprivate getProductEmbed(product: ProductProps) {\r\n\r\n\t\tconst emmbed = new EmbedBuilder()\r\n\t\t\t.setColor(MemoryCreateConfig.get(product.id)?.color || BotConfig.color)\r\n\t\t\t.setTitle(\"Sistema de compra\")\r\n\t\t\t.setDescription(\r\n\t\t\t\tproduct.info.discordDescription ||\r\n\t\t\t\t\tnew TurndownService().turndown(product.info.description || \"\") ||\r\n\t\t\t\t\t\"Sem descri√ß√£o\",\r\n\t\t\t)\r\n\t\t\t.setImage(product.info.discordMainImage || product.info.mainImage || \"\");\r\n\r\n\t\tif (product.settings.viewType === \"NORMAL\") {\r\n\t\t\temmbed.addFields(\r\n\t\t\t\t{ name: \"üåê Produto\", value: `\\`\\`\\`${product.info.title}\\`\\`\\`` },\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"üíµ Valor\",\r\n\t\t\t\t\tvalue: `\\`\\`\\`${formatPrice(product.pricing.price)}\\`\\`\\``,\r\n\t\t\t\t\tinline: true,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: \"üì¶ Estoque dispon√≠vel pra compra\",\r\n\t\t\t\t\tvalue:\r\n\t\t\t\t\t\tproduct.readonly.stockQuantityAvailable === null\r\n\t\t\t\t\t\t\t? `\\`\\`\\`‚àû Ilimitado\\`\\`\\``\r\n\t\t\t\t\t\t\t: `\\`\\`\\`${product.readonly.stockQuantityAvailable} Unidades\\`\\`\\``,\r\n\t\t\t\t\tinline: true,\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn emmbed;\r\n\t}\r\n\r\n\tasync getProductCard(product: ProductProps) {\r\n\t\tconst normalEmmbed = this.getProductEmbed(product);\r\n\t\tconst normalPurchaseButton =\r\n\t\t\tproduct.settings.viewType === \"NORMAL\"\r\n\t\t\t\t? this.addToCartButtonComponent.createCartButton(product)\r\n\t\t\t\t: await this.addToCartButtonComponent.createDynamicItemsSelect(product);\r\n\r\n\t\treturn { normalEmmbed, normalPurchaseButton };\r\n\t}\r\n\r\n\tasync sendProductCardToChannel({ channel, product }: { product: ProductProps; channel: TextChannel }) {\r\n\t\tconst { normalEmmbed, normalPurchaseButton } = await this.getProductCard(product);\r\n\r\n\t\tconst reply = await channel.send({\r\n\t\t\tembeds: [normalEmmbed],\r\n\t\t\tcomponents: [normalPurchaseButton],\r\n\t\t});\r\n\t\treturn reply;\r\n\t}\r\n}\r\n"],"names":["ProductCardComponent","getProductEmbed","product","emmbed","EmbedBuilder","setColor","MemoryCreateConfig","get","id","color","BotConfig","setTitle","setDescription","info","discordDescription","TurndownService","turndown","description","setImage","discordMainImage","mainImage","settings","viewType","addFields","name","value","title","formatPrice","pricing","price","inline","readonly","stockQuantityAvailable","getProductCard","normalEmmbed","normalPurchaseButton","addToCartButtonComponent","createCartButton","createDynamicItemsSelect","sendProductCardToChannel","channel","reply","send","embeds","components"],"mappings":";;;;+BAsBaA;;;eAAAA;;;wBAtBc;yBAapB;wBACmB;qBAEE;iEACA;iCACa;oCACN;;;;;;;;;;;;;;;AAG5B,IAAA,AAAMA,uBAAN,MAAMA;IAGJC,gBAAgBC,OAAqB,EAAE;QAE9C,MAAMC,SAAS,IAAIC,qBAAY,GAC7BC,QAAQ,CAACC,sCAAkB,CAACC,GAAG,CAACL,QAAQM,EAAE,GAAGC,SAASC,iBAAS,CAACD,KAAK,EACrEE,QAAQ,CAAC,qBACTC,cAAc,CACdV,QAAQW,IAAI,CAACC,kBAAkB,IAC9B,IAAIC,iBAAe,GAAGC,QAAQ,CAACd,QAAQW,IAAI,CAACI,WAAW,IAAI,OAC3D,iBAEDC,QAAQ,CAAChB,QAAQW,IAAI,CAACM,gBAAgB,IAAIjB,QAAQW,IAAI,CAACO,SAAS,IAAI;QAEtE,IAAIlB,QAAQmB,QAAQ,CAACC,QAAQ,KAAK,UAAU;YAC3CnB,OAAOoB,SAAS,CACf;gBAAEC,MAAM;gBAAcC,OAAO,CAAC,MAAM,EAAEvB,QAAQW,IAAI,CAACa,KAAK,CAAC,MAAM,CAAC;YAAC,GACjE;gBACCF,MAAM;gBACNC,OAAO,CAAC,MAAM,EAAEE,IAAAA,gBAAW,EAACzB,QAAQ0B,OAAO,CAACC,KAAK,EAAE,MAAM,CAAC;gBAC1DC,QAAQ;YACT,GACA;gBACCN,MAAM;gBACNC,OACCvB,QAAQ6B,QAAQ,CAACC,sBAAsB,KAAK,OACzC,CAAC,uBAAuB,CAAC,GACzB,CAAC,MAAM,EAAE9B,QAAQ6B,QAAQ,CAACC,sBAAsB,CAAC,eAAe,CAAC;gBACrEF,QAAQ;YACT;QAEF;QACA,OAAO3B;IACR;IAEA,MAAM8B,eAAe/B,OAAqB,EAAE;QAC3C,MAAMgC,eAAe,IAAI,CAACjC,eAAe,CAACC;QAC1C,MAAMiC,uBACLjC,QAAQmB,QAAQ,CAACC,QAAQ,KAAK,WAC3B,IAAI,CAACc,wBAAwB,CAACC,gBAAgB,CAACnC,WAC/C,MAAM,IAAI,CAACkC,wBAAwB,CAACE,wBAAwB,CAACpC;QAEjE,OAAO;YAAEgC;YAAcC;QAAqB;IAC7C;IAEA,MAAMI,yBAAyB,EAAEC,OAAO,EAAEtC,OAAO,EAAmD,EAAE;QACrG,MAAM,EAAEgC,YAAY,EAAEC,oBAAoB,EAAE,GAAG,MAAM,IAAI,CAACF,cAAc,CAAC/B;QAEzE,MAAMuC,QAAQ,MAAMD,QAAQE,IAAI,CAAC;YAChCC,QAAQ;gBAACT;aAAa;YACtBU,YAAY;gBAACT;aAAqB;QACnC;QACA,OAAOM;IACR;IArDA,YAAY,AAAiBL,wBAAkD,CAAE;aAApDA,2BAAAA;IAAqD;AAsDnF"}