{"version":3,"sources":["../../../../../src/bot/checkout/components/checkout-card/checkout-card.ts"],"sourcesContent":["import { Inject, Injectable } from \"@nestjs/common\";\r\nimport { Modal, Context, SlashCommand, SlashCommandContext, Ctx, ModalContext } from \"necord\";\r\nimport {\r\n\tActionRowBuilder,\r\n\tCacheType,\r\n\tChatInputCommandInteraction,\r\n\tClient,\r\n\tEmbedBuilder,\r\n\tMessage,\r\n\tModalActionRowComponentBuilder,\r\n\tModalBuilder,\r\n\tModalSubmitInteraction,\r\n\tTextChannel,\r\n\tTextInputBuilder,\r\n\tTextInputStyle,\r\n} from \"discord.js\";\r\nimport { BotConfig } from \"@/config\";\r\nimport { ProductProps } from \"@/@shared/sharpify/api\";\r\nimport { formatPrice } from \"@/@shared/lib\";\r\nimport TurndownService from \"turndown\";\r\nimport { DiscordUserEntity, ProductEntity } from \"@/@shared/db/entities\";\r\nimport { ValidateDatabaseCartItemsHelper } from \"../../helpers\";\r\nimport { formatCheckoutCartItemNameHelper, getCheckoutCartItemsHelper } from \"./helper\";\r\nimport { CartEmmbedComponent } from \"./components/cart-emmbed\";\r\nimport { SectionManagerHandler } from \"./section-manager\";\r\n\r\n@Injectable()\r\nexport class CheckoutCardComponent {\r\n\tconstructor(\r\n\t\t@Inject(Client) private readonly client: Client,\r\n\t\tprivate readonly sectionManagerHandler: SectionManagerHandler,\r\n\t) {}\r\n\r\n\tasync sendCheckoutCardToChannel({\r\n\t\tchannel,\r\n\t\tdiscordUser,\r\n\t}: {\r\n\t\tdiscordUser: DiscordUserEntity;\r\n\t\tchannel: TextChannel;\r\n\t}): Promise<Message<true>> {\r\n\t\tconst result = await this.sectionManagerHandler.setSection({ discordUserId: discordUser.id, section: \"MAIN\" });\r\n\t\treturn channel.send(result);\r\n\t}\r\n\r\n\tasync editCheckoutCardToChannel({\r\n\t\tchannel,\r\n\t\tdiscordUser,\r\n\t\tmessageId,\r\n\t}: {\r\n\t\tdiscordUser: DiscordUserEntity;\r\n\t\tchannel: TextChannel;\r\n\t\tmessageId: string;\r\n\t}) {\r\n\t\tconst result = await this.sectionManagerHandler.setSection({ discordUserId: discordUser.id, section: \"MAIN\" });\r\n\r\n\t\tconst message = await channel.messages.fetch(messageId).catch(() => null);\r\n\t\tawait message?.edit(result as any);\r\n\t}\r\n}\r\n"],"names":["CheckoutCardComponent","sendCheckoutCardToChannel","channel","discordUser","result","sectionManagerHandler","setSection","discordUserId","id","section","send","editCheckoutCardToChannel","messageId","message","messages","fetch","catch","edit","client"],"mappings":";;;;+BA2BaA;;;eAAAA;;;wBA3BsB;yBAe5B;gCAS+B;;;;;;;;;;;;;;;AAG/B,IAAA,AAAMA,wBAAN,MAAMA;IAMZ,MAAMC,0BAA0B,EAC/BC,OAAO,EACPC,WAAW,EAIX,EAA0B;QAC1B,MAAMC,SAAS,MAAM,IAAI,CAACC,qBAAqB,CAACC,UAAU,CAAC;YAAEC,eAAeJ,YAAYK,EAAE;YAAEC,SAAS;QAAO;QAC5G,OAAOP,QAAQQ,IAAI,CAACN;IACrB;IAEA,MAAMO,0BAA0B,EAC/BT,OAAO,EACPC,WAAW,EACXS,SAAS,EAKT,EAAE;QACF,MAAMR,SAAS,MAAM,IAAI,CAACC,qBAAqB,CAACC,UAAU,CAAC;YAAEC,eAAeJ,YAAYK,EAAE;YAAEC,SAAS;QAAO;QAE5G,MAAMI,UAAU,MAAMX,QAAQY,QAAQ,CAACC,KAAK,CAACH,WAAWI,KAAK,CAAC,IAAM;QACpE,MAAMH,SAASI,KAAKb;IACrB;IA7BA,YACC,AAAiCc,MAAc,EAC/C,AAAiBb,qBAA4C,CAC5D;aAFgCa,SAAAA;aAChBb,wBAAAA;IACf;AA2BJ"}