{"version":3,"sources":["../src/log-channel.service.ts"],"sourcesContent":["import { ExternalEventsEntity } from \"@/@shared/db/entities\";\r\nimport { getLocalStoreConfig, Sharpify } from \"@/@shared/sharpify\";\r\nimport { Inject, Injectable } from \"@nestjs/common\";\r\nimport { Cron, CronExpression } from \"@nestjs/schedule\";\r\nimport { Client, MessageCreateOptions, MessagePayload, TextChannel } from \"discord.js\";\r\nimport { dotEnv } from \"./@shared/lib\";\r\n\r\n@Injectable()\r\nexport class LogChannel {\r\n\tconstructor(@Inject(Client) private readonly client: Client) {}\r\n\tasync sendMessage(options: string | MessagePayload | MessageCreateOptions) {\r\n\t\tconst storeEntity = await getLocalStoreConfig();\r\n\t\tconst storePreferences = storeEntity.getPreferences();\r\n\t\tif (!storePreferences.failLog.enabled) return;\r\n\r\n\t\tconst guild = await this.client.guilds.fetch(process.env.DISCORD_GUILD_ID!).catch(() => null);\r\n\t\tif (!guild) return;\r\n\r\n\t\tconst channel = (await this.client?.channels.fetch(storePreferences.failLog.channelId!).catch(() => null)) as TextChannel;\r\n\t\tif (!channel || !channel.isTextBased()) return;\r\n\t\tawait channel.send(options).catch((err) => {\r\n\t\t\tconsole.error(\"‚ùå Failed to send log message:\", err);\r\n\t\t});\r\n\t}\r\n}\r\n"],"names":["LogChannel","sendMessage","options","storeEntity","getLocalStoreConfig","storePreferences","getPreferences","failLog","enabled","guild","client","guilds","fetch","process","env","DISCORD_GUILD_ID","catch","channel","channels","channelId","isTextBased","send","err","console","error"],"mappings":";;;;+BAQaA;;;eAAAA;;;0BAPiC;wBACX;yBAEuC;;;;;;;;;;;;;;;AAInE,IAAA,AAAMA,aAAN,MAAMA;IAEZ,MAAMC,YAAYC,OAAuD,EAAE;QAC1E,MAAMC,cAAc,MAAMC,IAAAA,6BAAmB;QAC7C,MAAMC,mBAAmBF,YAAYG,cAAc;QACnD,IAAI,CAACD,iBAAiBE,OAAO,CAACC,OAAO,EAAE;QAEvC,MAAMC,QAAQ,MAAM,IAAI,CAACC,MAAM,CAACC,MAAM,CAACC,KAAK,CAACC,QAAQC,GAAG,CAACC,gBAAgB,EAAGC,KAAK,CAAC,IAAM;QACxF,IAAI,CAACP,OAAO;QAEZ,MAAMQ,UAAW,MAAM,IAAI,CAACP,MAAM,EAAEQ,SAASN,MAAMP,iBAAiBE,OAAO,CAACY,SAAS,EAAGH,MAAM,IAAM;QACpG,IAAI,CAACC,WAAW,CAACA,QAAQG,WAAW,IAAI;QACxC,MAAMH,QAAQI,IAAI,CAACnB,SAASc,KAAK,CAAC,CAACM;YAClCC,QAAQC,KAAK,CAAC,iCAAiCF;QAChD;IACD;IAdA,YAAY,AAAiCZ,MAAc,CAAE;aAAhBA,SAAAA;IAAiB;AAe/D"}