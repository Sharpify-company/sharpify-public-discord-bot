{"version":3,"sources":["../../../../../../../src/bot/preferences/commands/configure-preferences/components/feedback-private-log/enable-private-log-button.ts"],"sourcesContent":["import { forwardRef, Inject, Injectable } from \"@nestjs/common\";\r\nimport {\r\n\tModal,\r\n\tContext,\r\n\tSlashCommand,\r\n\tSlashCommandContext,\r\n\tCtx,\r\n\tModalContext,\r\n\tStringSelect,\r\n\tStringSelectContext,\r\n\tSelectedStrings,\r\n\tButton,\r\n\tComponentParam,\r\n\tModalParam,\r\n} from \"necord\";\r\nimport {\r\n\tActionRowBuilder,\r\n\tButtonBuilder,\r\n\tButtonInteraction,\r\n\tButtonStyle,\r\n\tCacheType,\r\n\tChatInputCommandInteraction,\r\n\tClient,\r\n\tEmbedBuilder,\r\n\tLabelBuilder,\r\n\tMessage,\r\n\tModalActionRowComponentBuilder,\r\n\tModalBuilder,\r\n\tModalSubmitInteraction,\r\n\tStringSelectMenuBuilder,\r\n\tTextChannel,\r\n\tTextInputBuilder,\r\n\tTextInputStyle,\r\n} from \"discord.js\";\r\nimport { BotConfig } from \"@/config\";\r\nimport { ProductProps } from \"@/@shared/sharpify/api\";\r\nimport { formatPrice } from \"@/@shared/lib\";\r\nimport TurndownService from \"turndown\";\r\nimport { DiscordUserEntity, EmojiEntity, ProductEntity } from \"@/@shared/db/entities\";\r\n\r\nimport { WrapperType } from \"@/@shared/types\";\r\n\r\nimport { HandleDiscordMemberNotFound } from \"@/@shared/handlers\";\r\nimport { FindEmojiHelper } from \"@/@shared/helpers\";\r\nimport { getLocalStoreConfig, Sharpify } from \"@/@shared/sharpify\";\r\nimport { BuildFeedbackPrivateLogSection } from \"./_build-feedback-private-log-section\";\r\n\r\n@Injectable()\r\nexport class EnableFeedbackPrivateLogButton {\r\n\tconstructor(\r\n\t\t@Inject(Client) private readonly client: Client,\r\n\t\t@Inject(forwardRef(() => BuildFeedbackPrivateLogSection))\r\n\t\tprivate readonly buildFeedbackPrivateLogSection: WrapperType<BuildFeedbackPrivateLogSection>,\r\n\t) {}\r\n\r\n\t@Button(\"disable_feedback_private_log\")\r\n\tprivate async disablePulicLog(@Context() [interaction]: [ButtonInteraction]) {\r\n\t\tconst store = await getLocalStoreConfig();\r\n\t\tconst preferences = store.getPreferences();\r\n\t\tpreferences.feedbackPrivateLog.enabled = false;\r\n\t\tawait store.savePreferences(preferences);\r\n\r\n\t\tawait interaction.update((await this.buildFeedbackPrivateLogSection.build()) as any);\r\n\t}\r\n\r\n\t@Button(\"enable_feedback_private_log\")\r\n\tprivate async enablePrivateLog(@Context() [interaction]: [ButtonInteraction]) {\r\n\t\tconst store = await getLocalStoreConfig();\r\n\t\tconst preferences = store.getPreferences();\r\n\t\tpreferences.feedbackPrivateLog.enabled = true;\r\n\t\tawait store.savePreferences(preferences);\r\n\r\n\t\tawait interaction.update((await this.buildFeedbackPrivateLogSection.build()) as any);\r\n\t}\r\n\r\n\tasync createButton() {\r\n\t\tconst storeEntity = await getLocalStoreConfig();\r\n\r\n\t\tlet enableFeedbackPrivateLogButton: ButtonBuilder = null!;\r\n\t\tconst preferences = storeEntity.getPreferences();\r\n\t\tif (preferences.feedbackPrivateLog.enabled) {\r\n\t\t\tenableFeedbackPrivateLogButton = new ButtonBuilder()\r\n\t\t\t\t.setCustomId(\"disable_feedback_private_log\")\r\n\t\t\t\t.setLabel(\"Desativar log de feedback Privado\")\r\n\t\t\t\t.setStyle(ButtonStyle.Danger);\r\n\t\t} else {\r\n\t\t\tenableFeedbackPrivateLogButton = new ButtonBuilder()\r\n\t\t\t\t.setCustomId(\"enable_feedback_private_log\")\r\n\t\t\t\t.setLabel(\"Ativar log de feedback privado\")\r\n\t\t\t\t.setStyle(ButtonStyle.Success);\r\n\t\t}\r\n\r\n\t\treturn { enableFeedbackPrivateLogButton };\r\n\t}\r\n}\r\n"],"names":["EnableFeedbackPrivateLogButton","disablePulicLog","interaction","store","getLocalStoreConfig","preferences","getPreferences","feedbackPrivateLog","enabled","savePreferences","update","buildFeedbackPrivateLogSection","build","enablePrivateLog","createButton","storeEntity","enableFeedbackPrivateLogButton","ButtonBuilder","setCustomId","setLabel","setStyle","ButtonStyle","Danger","Success","client","BuildFeedbackPrivateLogSection"],"mappings":";;;;+BAgDaA;;;eAAAA;;;wBAhDkC;wBAcxC;yBAmBA;uBAOqB;0BAIkB;gDACC;;;;;;;;;;;;;;;AAGxC,IAAA,AAAMA,iCAAN,MAAMA;IAOZ,MACcC,gBAAgB,AAAW,CAACC,YAAiC,EAAE;QAC5E,MAAMC,QAAQ,MAAMC,IAAAA,6BAAmB;QACvC,MAAMC,cAAcF,MAAMG,cAAc;QACxCD,YAAYE,kBAAkB,CAACC,OAAO,GAAG;QACzC,MAAML,MAAMM,eAAe,CAACJ;QAE5B,MAAMH,YAAYQ,MAAM,CAAE,MAAM,IAAI,CAACC,8BAA8B,CAACC,KAAK;IAC1E;IAEA,MACcC,iBAAiB,AAAW,CAACX,YAAiC,EAAE;QAC7E,MAAMC,QAAQ,MAAMC,IAAAA,6BAAmB;QACvC,MAAMC,cAAcF,MAAMG,cAAc;QACxCD,YAAYE,kBAAkB,CAACC,OAAO,GAAG;QACzC,MAAML,MAAMM,eAAe,CAACJ;QAE5B,MAAMH,YAAYQ,MAAM,CAAE,MAAM,IAAI,CAACC,8BAA8B,CAACC,KAAK;IAC1E;IAEA,MAAME,eAAe;QACpB,MAAMC,cAAc,MAAMX,IAAAA,6BAAmB;QAE7C,IAAIY,iCAAgD;QACpD,MAAMX,cAAcU,YAAYT,cAAc;QAC9C,IAAID,YAAYE,kBAAkB,CAACC,OAAO,EAAE;YAC3CQ,iCAAiC,IAAIC,sBAAa,GAChDC,WAAW,CAAC,gCACZC,QAAQ,CAAC,qCACTC,QAAQ,CAACC,oBAAW,CAACC,MAAM;QAC9B,OAAO;YACNN,iCAAiC,IAAIC,sBAAa,GAChDC,WAAW,CAAC,+BACZC,QAAQ,CAAC,kCACTC,QAAQ,CAACC,oBAAW,CAACE,OAAO;QAC/B;QAEA,OAAO;YAAEP;QAA+B;IACzC;IA5CA,YACC,AAAiCQ,MAAc,EAC/C,AACiBb,8BAA2E,CAC3F;aAHgCa,SAAAA;aAEhBb,iCAAAA;IACf;AAyCJ;;;;;;;;;;;;;;;;;;;;;;iEA3C2Bc,8DAA8B"}