{"version":3,"sources":["../../../../../../../src/bot/preferences/commands/configure-preferences/components/sales-private-log/only-discord-sales.button.ts"],"sourcesContent":["import { forwardRef, Inject, Injectable } from \"@nestjs/common\";\r\nimport {\r\n    Modal,\r\n    Context,\r\n    SlashCommand,\r\n    SlashCommandContext,\r\n    Ctx,\r\n    ModalContext,\r\n    StringSelect,\r\n    StringSelectContext,\r\n    SelectedStrings,\r\n    Button,\r\n    ComponentParam,\r\n    ModalParam,\r\n} from \"necord\";\r\nimport {\r\n    ActionRowBuilder,\r\n    ButtonBuilder,\r\n    ButtonInteraction,\r\n    ButtonStyle,\r\n    CacheType,\r\n    ChatInputCommandInteraction,\r\n    Client,\r\n    EmbedBuilder,\r\n    LabelBuilder,\r\n    Message,\r\n    ModalActionRowComponentBuilder,\r\n    ModalBuilder,\r\n    ModalSubmitInteraction,\r\n    StringSelectMenuBuilder,\r\n    TextChannel,\r\n    TextInputBuilder,\r\n    TextInputStyle,\r\n} from \"discord.js\";\r\nimport { BotConfig } from \"@/config\";\r\nimport { ProductProps } from \"@/@shared/sharpify/api\";\r\nimport { formatPrice } from \"@/@shared/lib\";\r\nimport TurndownService from \"turndown\";\r\nimport { DiscordUserEntity, EmojiEntity, ProductEntity } from \"@/@shared/db/entities\";\r\n\r\nimport { WrapperType } from \"@/@shared/types\";\r\n\r\nimport { HandleDiscordMemberNotFound } from \"@/@shared/handlers\";\r\nimport { FindEmojiHelper } from \"@/@shared/helpers\";\r\nimport { getLocalStoreConfig, Sharpify } from \"@/@shared/sharpify\";\r\nimport { BuildSalesPrivateLogSection } from \"./_build-sales-private-log-section\";\r\n\r\n@Injectable()\r\nexport class OnlyDiscordSalesPrivateLogButton {\r\n    constructor(\r\n        @Inject(Client) private readonly client: Client,\r\n        @Inject(forwardRef(() => BuildSalesPrivateLogSection))\r\n        private readonly buildSalesPrivateLogSection: WrapperType<BuildSalesPrivateLogSection>,\r\n    ) {}\r\n\r\n    @Button(\"disable_only_discord_sales_private_log\")\r\n    private async disablePulicLog(@Context() [interaction]: [ButtonInteraction]) {\r\n        const store = await getLocalStoreConfig();\r\n        const preferences = store.getPreferences();\r\n        preferences.privateLogSales.onlyDiscordSales = false;\r\n        await store.savePreferences(preferences);\r\n\r\n        await interaction.update((await this.buildSalesPrivateLogSection.build()) as any);\r\n    }\r\n\r\n    @Button(\"enable_only_discord_sales_private_log\")\r\n    private async enablePrivateLog(@Context() [interaction]: [ButtonInteraction]) {\r\n        const store = await getLocalStoreConfig();\r\n        const preferences = store.getPreferences();\r\n        preferences.privateLogSales.onlyDiscordSales = true;\r\n        await store.savePreferences(preferences);\r\n\r\n        await interaction.update((await this.buildSalesPrivateLogSection.build()) as any);\r\n    }\r\n\r\n    async createButton() {\r\n        const storeEntity = await getLocalStoreConfig();\r\n\r\n        let onlyDiscordSalesPrivateLogButton: ButtonBuilder = null!;\r\n        const preferences = storeEntity.getPreferences();\r\n        if (preferences.privateLogSales.onlyDiscordSales) {\r\n            onlyDiscordSalesPrivateLogButton = new ButtonBuilder()\r\n                .setCustomId(\"disable_only_discord_sales_private_log\")\r\n                .setLabel(\"Desativar somente vendas feita pelo Discord\")\r\n                .setStyle(ButtonStyle.Danger);\r\n        } else {\r\n            onlyDiscordSalesPrivateLogButton = new ButtonBuilder()\r\n                .setCustomId(\"enable_only_discord_sales_private_log\")\r\n                .setLabel(\"Ativar somente vendas feita pelo Discord\")\r\n                .setStyle(ButtonStyle.Success);\r\n        }\r\n\r\n        return { onlyDiscordSalesPrivateLogButton };\r\n    }\r\n}\r\n"],"names":["OnlyDiscordSalesPrivateLogButton","disablePulicLog","interaction","store","getLocalStoreConfig","preferences","getPreferences","privateLogSales","onlyDiscordSales","savePreferences","update","buildSalesPrivateLogSection","build","enablePrivateLog","createButton","storeEntity","onlyDiscordSalesPrivateLogButton","ButtonBuilder","setCustomId","setLabel","setStyle","ButtonStyle","Danger","Success","client","BuildSalesPrivateLogSection"],"mappings":";;;;+BAgDaA;;;eAAAA;;;wBAhDkC;wBAcxC;yBAmBA;uBAOqB;0BAIkB;6CACF;;;;;;;;;;;;;;;AAGrC,IAAA,AAAMA,mCAAN,MAAMA;IAOT,MACcC,gBAAgB,AAAW,CAACC,YAAiC,EAAE;QACzE,MAAMC,QAAQ,MAAMC,IAAAA,6BAAmB;QACvC,MAAMC,cAAcF,MAAMG,cAAc;QACxCD,YAAYE,eAAe,CAACC,gBAAgB,GAAG;QAC/C,MAAML,MAAMM,eAAe,CAACJ;QAE5B,MAAMH,YAAYQ,MAAM,CAAE,MAAM,IAAI,CAACC,2BAA2B,CAACC,KAAK;IAC1E;IAEA,MACcC,iBAAiB,AAAW,CAACX,YAAiC,EAAE;QAC1E,MAAMC,QAAQ,MAAMC,IAAAA,6BAAmB;QACvC,MAAMC,cAAcF,MAAMG,cAAc;QACxCD,YAAYE,eAAe,CAACC,gBAAgB,GAAG;QAC/C,MAAML,MAAMM,eAAe,CAACJ;QAE5B,MAAMH,YAAYQ,MAAM,CAAE,MAAM,IAAI,CAACC,2BAA2B,CAACC,KAAK;IAC1E;IAEA,MAAME,eAAe;QACjB,MAAMC,cAAc,MAAMX,IAAAA,6BAAmB;QAE7C,IAAIY,mCAAkD;QACtD,MAAMX,cAAcU,YAAYT,cAAc;QAC9C,IAAID,YAAYE,eAAe,CAACC,gBAAgB,EAAE;YAC9CQ,mCAAmC,IAAIC,sBAAa,GAC/CC,WAAW,CAAC,0CACZC,QAAQ,CAAC,+CACTC,QAAQ,CAACC,oBAAW,CAACC,MAAM;QACpC,OAAO;YACHN,mCAAmC,IAAIC,sBAAa,GAC/CC,WAAW,CAAC,yCACZC,QAAQ,CAAC,4CACTC,QAAQ,CAACC,oBAAW,CAACE,OAAO;QACrC;QAEA,OAAO;YAAEP;QAAiC;IAC9C;IA5CA,YACI,AAAiCQ,MAAc,EAC/C,AACiBb,2BAAqE,CACxF;aAHmCa,SAAAA;aAEhBb,8BAAAA;IAClB;AAyCP;;;;;;;;;;;;;;;;;;;;;;iEA3CiCc,wDAA2B"}