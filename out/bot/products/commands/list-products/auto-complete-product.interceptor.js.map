{"version":3,"sources":["../../../../../src/bot/products/commands/list-products/auto-complete-product.interceptor.ts"],"sourcesContent":["import { formatPrice } from \"@/@shared/lib\";\r\nimport { Sharpify } from \"@/@shared/sharpify\";\r\nimport { Injectable } from \"@nestjs/common\";\r\nimport { AutocompleteInteraction } from \"discord.js\";\r\nimport { AutocompleteInterceptor } from \"necord\";\r\n\r\n@Injectable()\r\nexport class ProductAutocompleteInterceptor extends AutocompleteInterceptor {\r\n\tpublic async transformOptions(interaction: AutocompleteInteraction) {\r\n\t\tconst focused = interaction.options.getFocused(true);\r\n\r\n\t\tconst req = await Sharpify.api.v1.catalog.product.list({\r\n\t\t\tlimit: 10,\r\n\t\t\tpage: 1,\r\n\t\t\ttitle: focused.value.toString(),\r\n\t\t\tincludeNonListed: true,\r\n\t\t});\r\n\t\tif (!req.success)\r\n\t\t\treturn interaction.respond([\r\n\t\t\t\t{\r\n\t\t\t\t\tname: `Error ao buscar produtos: ${req.errorName}`,\r\n\t\t\t\t\tvalue: \"0\",\r\n\t\t\t\t},\r\n\t\t\t]);\r\n\r\n\t\treturn interaction.respond(\r\n\t\t\treq.data.products.map((product) => ({\r\n\t\t\t\tname: `${product.info.title.slice(0, 40)}   |  ${formatPrice(product.readonly.lowestPrice)}   |    #${product.shortReference}`,\r\n\t\t\t\tvalue: product.id,\r\n\t\t\t})),\r\n\t\t);\r\n\t}\r\n}\r\n"],"names":["ProductAutocompleteInterceptor","AutocompleteInterceptor","transformOptions","interaction","focused","options","getFocused","req","Sharpify","api","v1","catalog","product","list","limit","page","title","value","toString","includeNonListed","success","respond","name","errorName","data","products","map","info","slice","formatPrice","readonly","lowestPrice","shortReference","id"],"mappings":";;;;+BAOaA;;;eAAAA;;;qBAPe;0BACH;wBACE;wBAEa;;;;;;;AAGjC,IAAA,AAAMA,iCAAN,MAAMA,uCAAuCC,+BAAuB;IAC1E,MAAaC,iBAAiBC,WAAoC,EAAE;QACnE,MAAMC,UAAUD,YAAYE,OAAO,CAACC,UAAU,CAAC;QAE/C,MAAMC,MAAM,MAAMC,kBAAQ,CAACC,GAAG,CAACC,EAAE,CAACC,OAAO,CAACC,OAAO,CAACC,IAAI,CAAC;YACtDC,OAAO;YACPC,MAAM;YACNC,OAAOZ,QAAQa,KAAK,CAACC,QAAQ;YAC7BC,kBAAkB;QACnB;QACA,IAAI,CAACZ,IAAIa,OAAO,EACf,OAAOjB,YAAYkB,OAAO,CAAC;YAC1B;gBACCC,MAAM,CAAC,0BAA0B,EAAEf,IAAIgB,SAAS,EAAE;gBAClDN,OAAO;YACR;SACA;QAEF,OAAOd,YAAYkB,OAAO,CACzBd,IAAIiB,IAAI,CAACC,QAAQ,CAACC,GAAG,CAAC,CAACd,UAAa,CAAA;gBACnCU,MAAM,GAAGV,QAAQe,IAAI,CAACX,KAAK,CAACY,KAAK,CAAC,GAAG,IAAI,MAAM,EAAEC,IAAAA,gBAAW,EAACjB,QAAQkB,QAAQ,CAACC,WAAW,EAAE,SAAS,EAAEnB,QAAQoB,cAAc,EAAE;gBAC9Hf,OAAOL,QAAQqB,EAAE;YAClB,CAAA;IAEF;AACD"}