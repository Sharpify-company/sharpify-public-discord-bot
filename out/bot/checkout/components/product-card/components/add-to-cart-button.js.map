{"version":3,"sources":["../../../../../../src/bot/checkout/components/product-card/components/add-to-cart-button.ts"],"sourcesContent":["import { Inject, Injectable } from \"@nestjs/common\";\r\nimport { Modal, Context, SlashCommand, SlashCommandContext, Ctx, ModalContext, Button, ComponentParam } from \"necord\";\r\nimport { ActionRowBuilder, ButtonBuilder, ButtonInteraction, ButtonStyle, Client, StringSelectMenuBuilder } from \"discord.js\";\r\nimport { BotConfig } from \"@/config\";\r\nimport { ProductProps } from \"@/@shared/sharpify/api\";\r\nimport { formatPrice } from \"@/@shared/lib\";\r\nimport TurndownService from \"turndown\";\r\nimport { EmojiEntity } from \"@/@shared/db/entities\";\r\n\r\n@Injectable()\r\nexport class AddToCartButtonComponent {\r\n\tconstructor(@Inject(Client) private readonly client: Client) {}\r\n\r\n\tasync createDynamicItemsSelect(product: ProductProps) {\r\n\t\tconst options = product.dynamicItems.map((item) => ({\r\n\t\t\tlabel: `${item.info.title}`,\r\n\t\t\tdescription: `ðŸ’¸ Valor: ${formatPrice(item.pricing.price)} | ðŸ“¦ Estoque ${item.inventory.stockQuantity === null ? \"Ilimitado\" : `${item.inventory.stockQuantity} unidades`}`,\r\n\t\t\tvalue: item.id,\r\n\t\t\temoji: product.readonly.stockQuantityAvailable !== null && product.readonly.stockQuantityAvailable <= 0 ? \"âŒ\" : \"ðŸ›’\",\r\n\t\t}));\r\n\r\n\r\n\r\n\t\tconst selectMenu = new StringSelectMenuBuilder()\r\n\t\t\t.setCustomId(`add_to_cart_${product.id}`)\r\n\t\t\t.setPlaceholder(\"Selecione um item...\")\r\n\t\t\t.addOptions(options);\r\n\r\n\t\tconst row = new ActionRowBuilder<StringSelectMenuBuilder>().addComponents(selectMenu);\r\n\r\n\t\treturn row;\r\n\t}\r\n\r\n\tcreateCartButton(product: ProductProps) {\r\n\t\t// Cria o botÃ£o\r\n\t\tconst button = new ButtonBuilder()\r\n\t\t\t.setCustomId(`add_to_cart_${product.id}:${product.normalItem.id}`)\r\n\t\t\t.setLabel(`ðŸ›’ Adicionar ao carrinho`)\r\n\t\t\t.setDisabled(product.readonly.stockQuantityAvailable !== null && product.readonly.stockQuantityAvailable <= 0)\r\n\t\t\t.setStyle(ButtonStyle.Success);\r\n\r\n\t\t// Coloca o botÃ£o dentro de uma action row\r\n\t\tconst row = new ActionRowBuilder<ButtonBuilder>().addComponents(button);\r\n\t\treturn row;\r\n\t}\r\n}\r\n"],"names":["AddToCartButtonComponent","createDynamicItemsSelect","product","options","dynamicItems","map","item","label","info","title","description","formatPrice","pricing","price","inventory","stockQuantity","value","id","emoji","readonly","stockQuantityAvailable","selectMenu","StringSelectMenuBuilder","setCustomId","setPlaceholder","addOptions","row","ActionRowBuilder","addComponents","createCartButton","button","ButtonBuilder","normalItem","setLabel","setDisabled","setStyle","ButtonStyle","Success","client"],"mappings":";;;;+BAUaA;;;eAAAA;;;wBAVsB;yBAE8E;qBAGrF;;;;;;;;;;;;;;;AAKrB,IAAA,AAAMA,2BAAN,MAAMA;IAGZ,MAAMC,yBAAyBC,OAAqB,EAAE;QACrD,MAAMC,UAAUD,QAAQE,YAAY,CAACC,GAAG,CAAC,CAACC,OAAU,CAAA;gBACnDC,OAAO,GAAGD,KAAKE,IAAI,CAACC,KAAK,EAAE;gBAC3BC,aAAa,CAAC,UAAU,EAAEC,IAAAA,gBAAW,EAACL,KAAKM,OAAO,CAACC,KAAK,EAAE,cAAc,EAAEP,KAAKQ,SAAS,CAACC,aAAa,KAAK,OAAO,cAAc,GAAGT,KAAKQ,SAAS,CAACC,aAAa,CAAC,SAAS,CAAC,EAAE;gBAC5KC,OAAOV,KAAKW,EAAE;gBACdC,OAAOhB,QAAQiB,QAAQ,CAACC,sBAAsB,KAAK,QAAQlB,QAAQiB,QAAQ,CAACC,sBAAsB,IAAI,IAAI,MAAM;YACjH,CAAA;QAIA,MAAMC,aAAa,IAAIC,gCAAuB,GAC5CC,WAAW,CAAC,CAAC,YAAY,EAAErB,QAAQe,EAAE,EAAE,EACvCO,cAAc,CAAC,wBACfC,UAAU,CAACtB;QAEb,MAAMuB,MAAM,IAAIC,yBAAgB,GAA4BC,aAAa,CAACP;QAE1E,OAAOK;IACR;IAEAG,iBAAiB3B,OAAqB,EAAE;QACvC,eAAe;QACf,MAAM4B,SAAS,IAAIC,sBAAa,GAC9BR,WAAW,CAAC,CAAC,YAAY,EAAErB,QAAQe,EAAE,CAAC,CAAC,EAAEf,QAAQ8B,UAAU,CAACf,EAAE,EAAE,EAChEgB,QAAQ,CAAC,CAAC,wBAAwB,CAAC,EACnCC,WAAW,CAAChC,QAAQiB,QAAQ,CAACC,sBAAsB,KAAK,QAAQlB,QAAQiB,QAAQ,CAACC,sBAAsB,IAAI,GAC3Ge,QAAQ,CAACC,oBAAW,CAACC,OAAO;QAE9B,0CAA0C;QAC1C,MAAMX,MAAM,IAAIC,yBAAgB,GAAkBC,aAAa,CAACE;QAChE,OAAOJ;IACR;IAjCA,YAAY,AAAiCY,MAAc,CAAE;aAAhBA,SAAAA;IAAiB;AAkC/D"}