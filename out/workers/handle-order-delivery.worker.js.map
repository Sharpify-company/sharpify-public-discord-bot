{"version":3,"sources":["../../src/workers/handle-order-delivery.worker.ts"],"sourcesContent":["import { ExternalEventsEntity, OrderEntity } from \"@/@shared/db/entities\";\r\nimport { Sharpify } from \"@/@shared/sharpify\";\r\nimport { Injectable, OnModuleInit } from \"@nestjs/common\";\r\nimport { Cron } from \"@nestjs/schedule\";\r\nimport { HandleProductEvent } from \"./usecases\";\r\nimport { HandleDeliverToDiscordUserPrivate } from \"./usecases/handle-deliver-to-discord-user-private\";\r\n\r\n@Injectable()\r\nexport class HandleOrderDeliveryWorker {\r\n\tconstructor(private readonly handleDeliverToDiscordUserPrivate: HandleDeliverToDiscordUserPrivate) {}\r\n\r\n\t@Cron(\"*/3 * * * * *\")\r\n\thandleCron() {\r\n\t\tthis.execute();\r\n\t}\r\n\r\n\tasync execute() {\r\n\t\tconst pendingDeliveringOrder = await OrderEntity.findBy({ deliveryStatus: \"PREPARING_DELIVERY\" });\r\n\r\n\t\tfor (const orderEntity of pendingDeliveringOrder) {\r\n\t\t\tawait this.handleDeliverToDiscordUserPrivate.execute({ orderEntity });\r\n\t\t}\r\n\t}\r\n}\r\n"],"names":["HandleOrderDeliveryWorker","handleCron","execute","pendingDeliveringOrder","OrderEntity","findBy","deliveryStatus","orderEntity","handleDeliverToDiscordUserPrivate"],"mappings":";;;;+BAQaA;;;eAAAA;;;0BARqC;wBAET;0BACpB;mDAE6B;;;;;;;;;;AAG3C,IAAA,AAAMA,4BAAN,MAAMA;IAIZC,aAAa;QACZ,IAAI,CAACC,OAAO;IACb;IAEA,MAAMA,UAAU;QACf,MAAMC,yBAAyB,MAAMC,qBAAW,CAACC,MAAM,CAAC;YAAEC,gBAAgB;QAAqB;QAE/F,KAAK,MAAMC,eAAeJ,uBAAwB;YACjD,MAAM,IAAI,CAACK,iCAAiC,CAACN,OAAO,CAAC;gBAAEK;YAAY;QACpE;IACD;IAbA,YAAY,AAAiBC,iCAAoE,CAAE;aAAtEA,oCAAAA;IAAuE;AAcrG"}