{"version":3,"sources":["../../../../../../src/bot/checkout/components/checkout-card/usecases/handle-order-cancelled.usecase.ts"],"sourcesContent":["import { Sharpify } from \"@/@shared/sharpify\";\r\nimport {\r\n\tActionRowBuilder,\r\n\tButtonBuilder,\r\n\tButtonInteraction,\r\n\tButtonStyle,\r\n\tCacheType,\r\n\tChannelType,\r\n\tClient,\r\n\tEmbedBuilder,\r\n\tPermissionsBitField,\r\n} from \"discord.js\";\r\nimport { dotEnv } from \"@/@shared/lib\";\r\n\r\nimport { ValidateDatabaseCartItemsHelper } from \"@/bot/checkout/helpers\";\r\nimport { Inject, Injectable } from \"@nestjs/common\";\r\nimport { DiscordUserEntity, OrderEntity } from \"@/@shared/db/entities\";\r\n\r\n@Injectable()\r\nexport class HandleOrderCancelledUsecase {\r\n\tconstructor(@Inject(Client) private readonly client: Client) {}\r\n\r\n\tasync execute({ discordUserId }: { discordUserId: string }) {\r\n\t\tconst discordUser = await DiscordUserEntity.findOneBy({ id: discordUserId });\r\n\t\tif (!discordUser) return;\r\n\r\n\t\tconst orderChannel = await this.client.channels.fetch(discordUser.cart.channelId!).catch(() => null);\r\n\t\torderChannel && (await orderChannel.delete().catch(() => null));\r\n\r\n\t\tawait discordUser.cart.cancelOrder();\r\n\t}\r\n}\r\n"],"names":["HandleOrderCancelledUsecase","execute","discordUserId","discordUser","DiscordUserEntity","findOneBy","id","orderChannel","client","channels","fetch","cart","channelId","catch","delete","cancelOrder"],"mappings":";;;;+BAmBaA;;;eAAAA;;;yBARN;wBAI4B;0BACY;;;;;;;;;;;;;;;AAGxC,IAAA,AAAMA,8BAAN,MAAMA;IAGZ,MAAMC,QAAQ,EAAEC,aAAa,EAA6B,EAAE;QAC3D,MAAMC,cAAc,MAAMC,2BAAiB,CAACC,SAAS,CAAC;YAAEC,IAAIJ;QAAc;QAC1E,IAAI,CAACC,aAAa;QAElB,MAAMI,eAAe,MAAM,IAAI,CAACC,MAAM,CAACC,QAAQ,CAACC,KAAK,CAACP,YAAYQ,IAAI,CAACC,SAAS,EAAGC,KAAK,CAAC,IAAM;QAC/FN,gBAAiB,MAAMA,aAAaO,MAAM,GAAGD,KAAK,CAAC,IAAM;QAEzD,MAAMV,YAAYQ,IAAI,CAACI,WAAW;IACnC;IAVA,YAAY,AAAiCP,MAAc,CAAE;aAAhBA,SAAAA;IAAiB;AAW/D"}