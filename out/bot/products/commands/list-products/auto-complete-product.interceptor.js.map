{"version":3,"sources":["../../../../../src/bot/products/commands/list-products/auto-complete-product.interceptor.ts"],"sourcesContent":["import { formatPrice } from '@/@shared/lib';\r\nimport { Sharpify } from '@/@shared/sharpify';\r\nimport { Injectable } from '@nestjs/common';\r\nimport { AutocompleteInteraction } from 'discord.js';\r\nimport { AutocompleteInterceptor } from 'necord';\r\n\r\n@Injectable()\r\nexport class ProductAutocompleteInterceptor extends AutocompleteInterceptor {\r\n  public async transformOptions(interaction: AutocompleteInteraction) {\r\n    const focused = interaction.options.getFocused(true);\r\n\r\n    const req = await Sharpify.api.v1.catalog.product.list({\r\n      limit: 10,\r\n      page: 1,\r\n      title: focused.value.toString(),\r\n      includeNonListed: true\r\n    });\r\n    if (!req.success)\r\n      return interaction.respond([\r\n        {\r\n          name: `Error ao buscar produtos: ${req.errorName}`,\r\n          value: '0',\r\n        },\r\n      ]);\r\n\r\n    return interaction.respond(\r\n      req.data.products.map((product) => ({\r\n        name: `${product.info.title}   |  ${formatPrice(product.readonly.lowestPrice)}   |    #${product.shortReference}`,\r\n        value: product.id,\r\n      })),\r\n    );\r\n  }\r\n}\r\n"],"names":["ProductAutocompleteInterceptor","AutocompleteInterceptor","transformOptions","interaction","focused","options","getFocused","req","Sharpify","api","v1","catalog","product","list","limit","page","title","value","toString","includeNonListed","success","respond","name","errorName","data","products","map","info","formatPrice","readonly","lowestPrice","shortReference","id"],"mappings":";;;;+BAOaA;;;eAAAA;;;qBAPe;0BACH;wBACE;wBAEa;;;;;;;AAGjC,IAAA,AAAMA,iCAAN,MAAMA,uCAAuCC,+BAAuB;IACzE,MAAaC,iBAAiBC,WAAoC,EAAE;QAClE,MAAMC,UAAUD,YAAYE,OAAO,CAACC,UAAU,CAAC;QAE/C,MAAMC,MAAM,MAAMC,kBAAQ,CAACC,GAAG,CAACC,EAAE,CAACC,OAAO,CAACC,OAAO,CAACC,IAAI,CAAC;YACrDC,OAAO;YACPC,MAAM;YACNC,OAAOZ,QAAQa,KAAK,CAACC,QAAQ;YAC7BC,kBAAkB;QACpB;QACA,IAAI,CAACZ,IAAIa,OAAO,EACd,OAAOjB,YAAYkB,OAAO,CAAC;YACzB;gBACEC,MAAM,CAAC,0BAA0B,EAAEf,IAAIgB,SAAS,EAAE;gBAClDN,OAAO;YACT;SACD;QAEH,OAAOd,YAAYkB,OAAO,CACxBd,IAAIiB,IAAI,CAACC,QAAQ,CAACC,GAAG,CAAC,CAACd,UAAa,CAAA;gBAClCU,MAAM,GAAGV,QAAQe,IAAI,CAACX,KAAK,CAAC,MAAM,EAAEY,IAAAA,gBAAW,EAAChB,QAAQiB,QAAQ,CAACC,WAAW,EAAE,SAAS,EAAElB,QAAQmB,cAAc,EAAE;gBACjHd,OAAOL,QAAQoB,EAAE;YACnB,CAAA;IAEJ;AACF"}